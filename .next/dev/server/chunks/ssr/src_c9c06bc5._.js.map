{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Proj/cafe-bakery-saas/src/components/ui/input.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Input({ className, type, ...props }: React.ComponentProps<\"input\">) {\n  return (\n    <input\n      type={type}\n      data-slot=\"input\"\n      className={cn(\n        \"file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        \"focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]\",\n        \"aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Input }\n"],"names":[],"mappings":";;;;;AAEA;;;AAEA,SAAS,MAAM,EAAE,SAAS,EAAE,IAAI,EAAE,GAAG,OAAsC;IACzE,qBACE,8OAAC;QACC,MAAM;QACN,aAAU;QACV,WAAW,IAAA,yHAAE,EACX,8bACA,iFACA,0GACA;QAED,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 29, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Proj/cafe-bakery-saas/src/components/ui/label.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport { Label as LabelPrimitive } from \"radix-ui\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Label({\n  className,\n  ...props\n}: React.ComponentProps<typeof LabelPrimitive.Root>) {\n  return (\n    <LabelPrimitive.Root\n      data-slot=\"label\"\n      className={cn(\n        \"flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Label }\n"],"names":[],"mappings":";;;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,MAAM,EACb,SAAS,EACT,GAAG,OAC8C;IACjD,qBACE,8OAAC,2MAAc,CAAC,IAAI;QAClB,aAAU;QACV,WAAW,IAAA,yHAAE,EACX,uNACA;QAED,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 56, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Proj/cafe-bakery-saas/src/components/ui/textarea.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Textarea({ className, ...props }: React.ComponentProps<\"textarea\">) {\n  return (\n    <textarea\n      data-slot=\"textarea\"\n      className={cn(\n        \"border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Textarea }\n"],"names":[],"mappings":";;;;;AAEA;;;AAEA,SAAS,SAAS,EAAE,SAAS,EAAE,GAAG,OAAyC;IACzE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,IAAA,yHAAE,EACX,ucACA;QAED,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 80, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Proj/cafe-bakery-saas/src/components/ui/select.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport { CheckIcon, ChevronDownIcon, ChevronUpIcon } from \"lucide-react\"\nimport { Select as SelectPrimitive } from \"radix-ui\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Select({\n  ...props\n}: React.ComponentProps<typeof SelectPrimitive.Root>) {\n  return <SelectPrimitive.Root data-slot=\"select\" {...props} />\n}\n\nfunction SelectGroup({\n  ...props\n}: React.ComponentProps<typeof SelectPrimitive.Group>) {\n  return <SelectPrimitive.Group data-slot=\"select-group\" {...props} />\n}\n\nfunction SelectValue({\n  ...props\n}: React.ComponentProps<typeof SelectPrimitive.Value>) {\n  return <SelectPrimitive.Value data-slot=\"select-value\" {...props} />\n}\n\nfunction SelectTrigger({\n  className,\n  size = \"default\",\n  children,\n  ...props\n}: React.ComponentProps<typeof SelectPrimitive.Trigger> & {\n  size?: \"sm\" | \"default\"\n}) {\n  return (\n    <SelectPrimitive.Trigger\n      data-slot=\"select-trigger\"\n      data-size={size}\n      className={cn(\n        \"border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <SelectPrimitive.Icon asChild>\n        <ChevronDownIcon className=\"size-4 opacity-50\" />\n      </SelectPrimitive.Icon>\n    </SelectPrimitive.Trigger>\n  )\n}\n\nfunction SelectContent({\n  className,\n  children,\n  position = \"item-aligned\",\n  align = \"center\",\n  ...props\n}: React.ComponentProps<typeof SelectPrimitive.Content>) {\n  return (\n    <SelectPrimitive.Portal>\n      <SelectPrimitive.Content\n        data-slot=\"select-content\"\n        className={cn(\n          \"bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md\",\n          position === \"popper\" &&\n            \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n          className\n        )}\n        position={position}\n        align={align}\n        {...props}\n      >\n        <SelectScrollUpButton />\n        <SelectPrimitive.Viewport\n          className={cn(\n            \"p-1\",\n            position === \"popper\" &&\n              \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1\"\n          )}\n        >\n          {children}\n        </SelectPrimitive.Viewport>\n        <SelectScrollDownButton />\n      </SelectPrimitive.Content>\n    </SelectPrimitive.Portal>\n  )\n}\n\nfunction SelectLabel({\n  className,\n  ...props\n}: React.ComponentProps<typeof SelectPrimitive.Label>) {\n  return (\n    <SelectPrimitive.Label\n      data-slot=\"select-label\"\n      className={cn(\"text-muted-foreground px-2 py-1.5 text-xs\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SelectItem({\n  className,\n  children,\n  ...props\n}: React.ComponentProps<typeof SelectPrimitive.Item>) {\n  return (\n    <SelectPrimitive.Item\n      data-slot=\"select-item\"\n      className={cn(\n        \"focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2\",\n        className\n      )}\n      {...props}\n    >\n      <span\n        data-slot=\"select-item-indicator\"\n        className=\"absolute right-2 flex size-3.5 items-center justify-center\"\n      >\n        <SelectPrimitive.ItemIndicator>\n          <CheckIcon className=\"size-4\" />\n        </SelectPrimitive.ItemIndicator>\n      </span>\n      <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n    </SelectPrimitive.Item>\n  )\n}\n\nfunction SelectSeparator({\n  className,\n  ...props\n}: React.ComponentProps<typeof SelectPrimitive.Separator>) {\n  return (\n    <SelectPrimitive.Separator\n      data-slot=\"select-separator\"\n      className={cn(\"bg-border pointer-events-none -mx-1 my-1 h-px\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SelectScrollUpButton({\n  className,\n  ...props\n}: React.ComponentProps<typeof SelectPrimitive.ScrollUpButton>) {\n  return (\n    <SelectPrimitive.ScrollUpButton\n      data-slot=\"select-scroll-up-button\"\n      className={cn(\n        \"flex cursor-default items-center justify-center py-1\",\n        className\n      )}\n      {...props}\n    >\n      <ChevronUpIcon className=\"size-4\" />\n    </SelectPrimitive.ScrollUpButton>\n  )\n}\n\nfunction SelectScrollDownButton({\n  className,\n  ...props\n}: React.ComponentProps<typeof SelectPrimitive.ScrollDownButton>) {\n  return (\n    <SelectPrimitive.ScrollDownButton\n      data-slot=\"select-scroll-down-button\"\n      className={cn(\n        \"flex cursor-default items-center justify-center py-1\",\n        className\n      )}\n      {...props}\n    >\n      <ChevronDownIcon className=\"size-4\" />\n    </SelectPrimitive.ScrollDownButton>\n  )\n}\n\nexport {\n  Select,\n  SelectContent,\n  SelectGroup,\n  SelectItem,\n  SelectLabel,\n  SelectScrollDownButton,\n  SelectScrollUpButton,\n  SelectSeparator,\n  SelectTrigger,\n  SelectValue,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAGA;AAAA;AAAA;AACA;AAEA;AANA;;;;;AAQA,SAAS,OAAO,EACd,GAAG,OAC+C;IAClD,qBAAO,8OAAC,8MAAe,CAAC,IAAI;QAAC,aAAU;QAAU,GAAG,KAAK;;;;;;AAC3D;AAEA,SAAS,YAAY,EACnB,GAAG,OACgD;IACnD,qBAAO,8OAAC,8MAAe,CAAC,KAAK;QAAC,aAAU;QAAgB,GAAG,KAAK;;;;;;AAClE;AAEA,SAAS,YAAY,EACnB,GAAG,OACgD;IACnD,qBAAO,8OAAC,8MAAe,CAAC,KAAK;QAAC,aAAU;QAAgB,GAAG,KAAK;;;;;;AAClE;AAEA,SAAS,cAAc,EACrB,SAAS,EACT,OAAO,SAAS,EAChB,QAAQ,EACR,GAAG,OAGJ;IACC,qBACE,8OAAC,8MAAe,CAAC,OAAO;QACtB,aAAU;QACV,aAAW;QACX,WAAW,IAAA,yHAAE,EACX,gzBACA;QAED,GAAG,KAAK;;YAER;0BACD,8OAAC,8MAAe,CAAC,IAAI;gBAAC,OAAO;0BAC3B,cAAA,8OAAC,2OAAe;oBAAC,WAAU;;;;;;;;;;;;;;;;;AAInC;AAEA,SAAS,cAAc,EACrB,SAAS,EACT,QAAQ,EACR,WAAW,cAAc,EACzB,QAAQ,QAAQ,EAChB,GAAG,OACkD;IACrD,qBACE,8OAAC,8MAAe,CAAC,MAAM;kBACrB,cAAA,8OAAC,8MAAe,CAAC,OAAO;YACtB,aAAU;YACV,WAAW,IAAA,yHAAE,EACX,ijBACA,aAAa,YACX,mIACF;YAEF,UAAU;YACV,OAAO;YACN,GAAG,KAAK;;8BAET,8OAAC;;;;;8BACD,8OAAC,8MAAe,CAAC,QAAQ;oBACvB,WAAW,IAAA,yHAAE,EACX,OACA,aAAa,YACX;8BAGH;;;;;;8BAEH,8OAAC;;;;;;;;;;;;;;;;AAIT;AAEA,SAAS,YAAY,EACnB,SAAS,EACT,GAAG,OACgD;IACnD,qBACE,8OAAC,8MAAe,CAAC,KAAK;QACpB,aAAU;QACV,WAAW,IAAA,yHAAE,EAAC,6CAA6C;QAC1D,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAClB,SAAS,EACT,QAAQ,EACR,GAAG,OAC+C;IAClD,qBACE,8OAAC,8MAAe,CAAC,IAAI;QACnB,aAAU;QACV,WAAW,IAAA,yHAAE,EACX,6aACA;QAED,GAAG,KAAK;;0BAET,8OAAC;gBACC,aAAU;gBACV,WAAU;0BAEV,cAAA,8OAAC,8MAAe,CAAC,aAAa;8BAC5B,cAAA,8OAAC,qNAAS;wBAAC,WAAU;;;;;;;;;;;;;;;;0BAGzB,8OAAC,8MAAe,CAAC,QAAQ;0BAAE;;;;;;;;;;;;AAGjC;AAEA,SAAS,gBAAgB,EACvB,SAAS,EACT,GAAG,OACoD;IACvD,qBACE,8OAAC,8MAAe,CAAC,SAAS;QACxB,aAAU;QACV,WAAW,IAAA,yHAAE,EAAC,iDAAiD;QAC9D,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,qBAAqB,EAC5B,SAAS,EACT,GAAG,OACyD;IAC5D,qBACE,8OAAC,8MAAe,CAAC,cAAc;QAC7B,aAAU;QACV,WAAW,IAAA,yHAAE,EACX,wDACA;QAED,GAAG,KAAK;kBAET,cAAA,8OAAC,qOAAa;YAAC,WAAU;;;;;;;;;;;AAG/B;AAEA,SAAS,uBAAuB,EAC9B,SAAS,EACT,GAAG,OAC2D;IAC9D,qBACE,8OAAC,8MAAe,CAAC,gBAAgB;QAC/B,aAAU;QACV,WAAW,IAAA,yHAAE,EACX,wDACA;QAED,GAAG,KAAK;kBAET,cAAA,8OAAC,2OAAe;YAAC,WAAU;;;;;;;;;;;AAGjC"}},
    {"offset": {"line": 315, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Proj/cafe-bakery-saas/src/components/ui/card.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Card({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card\"\n      className={cn(\n        \"bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-header\"\n      className={cn(\n        \"@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardTitle({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-title\"\n      className={cn(\"leading-none font-semibold\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardDescription({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-description\"\n      className={cn(\"text-muted-foreground text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardAction({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-action\"\n      className={cn(\n        \"col-start-2 row-span-2 row-start-1 self-start justify-self-end\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-content\"\n      className={cn(\"px-6\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-footer\"\n      className={cn(\"flex items-center px-6 [.border-t]:pt-6\", className)}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Card,\n  CardHeader,\n  CardFooter,\n  CardTitle,\n  CardAction,\n  CardDescription,\n  CardContent,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAEA;;;AAEA,SAAS,KAAK,EAAE,SAAS,EAAE,GAAG,OAAoC;IAChE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,IAAA,yHAAE,EACX,qFACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,IAAA,yHAAE,EACX,4JACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,UAAU,EAAE,SAAS,EAAE,GAAG,OAAoC;IACrE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,IAAA,yHAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,gBAAgB,EAAE,SAAS,EAAE,GAAG,OAAoC;IAC3E,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,IAAA,yHAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,IAAA,yHAAE,EACX,kEACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,YAAY,EAAE,SAAS,EAAE,GAAG,OAAoC;IACvE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,IAAA,yHAAE,EAAC,QAAQ;QACrB,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,IAAA,yHAAE,EAAC,2CAA2C;QACxD,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 417, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Proj/cafe-bakery-saas/src/app/dashboard/recipes/actions.ts"],"sourcesContent":["\"use server\";\n\nimport { createClient } from \"@/lib/supabase/server\";\nimport { revalidatePath } from \"next/cache\";\n\ninterface RecipeItemInput {\n  inputItemId: string;\n  quantity: number;\n  unit: string;\n}\n\ninterface CreateRecipeInput {\n  outputItemId: string;\n  outputQuantity: number;\n  items: RecipeItemInput[];\n  name?: string;\n  description?: string;\n}\n\nexport async function createRecipe(data: CreateRecipeInput) {\n  const supabase = await createClient();\n  const {\n    data: { user },\n  } = await supabase.auth.getUser();\n\n  if (!user) {\n    return { error: \"Unauthorized\" };\n  }\n\n  const { data: userRole } = await supabase\n    .from(\"user_roles\")\n    .select(\"store_id\")\n    .eq(\"user_id\", user.id)\n    .single();\n\n  if (!userRole?.store_id) {\n    return { error: \"Store not found\" };\n  }\n\n  const store_id = userRole.store_id;\n  const { outputItemId, outputQuantity, items, name, description } = data;\n\n  // Validation: Circular Reference Check\n  if (items.some((item) => item.inputItemId === outputItemId)) {\n    return { error: \"Self-reference detected: Output item cannot be an ingredient.\" };\n  }\n\n  // 1. Calculate next version\n  const { data: existingRecipes, error: versionError } = await supabase\n    .from(\"recipes\")\n    .select(\"version\")\n    .eq(\"store_id\", store_id)\n    .eq(\"output_item_id\", outputItemId)\n    .order(\"version\", { ascending: false })\n    .limit(1);\n\n  if (versionError) {\n    return { error: `Version check failed: ${versionError.message}` };\n  }\n\n  const nextVersion = existingRecipes && existingRecipes.length > 0\n    ? existingRecipes[0].version + 1\n    : 1;\n\n  // 2. Insert Recipe\n  const { data: recipe, error: recipeError } = await supabase\n    .from(\"recipes\")\n    .insert({\n      store_id,\n      output_item_id: outputItemId,\n      output_quantity: outputQuantity,\n      version: nextVersion,\n      is_active: true,\n      name,\n      description,\n    })\n    .select()\n    .single();\n\n  if (recipeError) {\n    return { error: `Recipe creation failed: ${recipeError.message}` };\n  }\n\n  // 3. Insert Recipe Items\n  if (items.length > 0) {\n    const recipeItems = items.map((item, index) => ({\n      recipe_id: recipe.id,\n      input_item_id: item.inputItemId,\n      quantity: item.quantity,\n      unit: item.unit,\n      sort_order: index,\n    }));\n\n    const { error: itemsError } = await supabase\n      .from(\"recipe_items\")\n      .insert(recipeItems);\n\n    if (itemsError) {\n      // Rollback: delete the recipe if items fail\n      await supabase.from(\"recipes\").delete().eq(\"id\", recipe.id);\n      return { error: `Failed to add ingredients: ${itemsError.message}` };\n    }\n  }\n\n  // 4. Deactivate previous versions\n  const { error: deactivateError } = await supabase\n    .from(\"recipes\")\n    .update({ is_active: false })\n    .eq(\"store_id\", store_id)\n    .eq(\"output_item_id\", outputItemId)\n    .neq(\"id\", recipe.id); // Exclude the new one\n\n  if (deactivateError) {\n    console.error(\"Failed to deactivate old recipes:\", deactivateError);\n  }\n\n  revalidatePath(\"/dashboard/recipes\");\n  return { success: true, recipeId: recipe.id };\n}\n\nexport async function calculateRecipeCost(items: RecipeItemInput[]) {\n  const supabase = await createClient();\n  let totalCost = 0;\n\n  // Fetch prices for all items\n  const itemIds = items.map((i) => i.inputItemId);\n  const { data: dbItems } = await supabase\n    .from(\"items\")\n    .select(\"id, base_unit, latest_purchase_price\")\n    .in(\"id\", itemIds);\n\n  if (!dbItems) return 0;\n\n  for (const item of items) {\n    const dbItem = dbItems.find((i) => i.id === item.inputItemId);\n    if (!dbItem || !dbItem.latest_purchase_price) continue;\n\n    // Convert unit\n    // We call the DB function for accurate conversion\n    const { data: convertedQty } = await supabase.rpc(\"convert_unit\", {\n      p_quantity: item.quantity,\n      p_from_unit: item.unit,\n      p_to_unit: dbItem.base_unit,\n      p_item_id: item.inputItemId\n    });\n\n    if (convertedQty !== null) {\n      totalCost += (convertedQty as number) * dbItem.latest_purchase_price;\n    }\n  }\n\n  return totalCost;\n}\n\nexport async function getRecipes() {\n  const supabase = await createClient();\n  const { data: { user } } = await supabase.auth.getUser();\n  if (!user) return [];\n\n  const { data } = await supabase\n    .from(\"recipes\")\n    .select(`\n      *,\n      output_item:items!output_item_id(name, code, base_unit),\n      recipe_items(\n        quantity,\n        unit,\n        input_item:items!input_item_id(name, base_unit, latest_purchase_price)\n      )\n    `)\n    .eq(\"is_active\", true)\n    .order(\"created_at\", { ascending: false });\n\n  return data || [];\n}"],"names":[],"mappings":";;;;;;;MAmBsB,wBAAA,WAAA,GAAA,IAAA,+OAAA,EAAA,8CAAA,oOAAA,EAAA,KAAA,GAAA,0OAAA,EAAA,gDAAA"}},
    {"offset": {"line": 431, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Proj/cafe-bakery-saas/src/app/dashboard/recipes/actions.ts"],"sourcesContent":["\"use server\";\n\nimport { createClient } from \"@/lib/supabase/server\";\nimport { revalidatePath } from \"next/cache\";\n\ninterface RecipeItemInput {\n  inputItemId: string;\n  quantity: number;\n  unit: string;\n}\n\ninterface CreateRecipeInput {\n  outputItemId: string;\n  outputQuantity: number;\n  items: RecipeItemInput[];\n  name?: string;\n  description?: string;\n}\n\nexport async function createRecipe(data: CreateRecipeInput) {\n  const supabase = await createClient();\n  const {\n    data: { user },\n  } = await supabase.auth.getUser();\n\n  if (!user) {\n    return { error: \"Unauthorized\" };\n  }\n\n  const { data: userRole } = await supabase\n    .from(\"user_roles\")\n    .select(\"store_id\")\n    .eq(\"user_id\", user.id)\n    .single();\n\n  if (!userRole?.store_id) {\n    return { error: \"Store not found\" };\n  }\n\n  const store_id = userRole.store_id;\n  const { outputItemId, outputQuantity, items, name, description } = data;\n\n  // Validation: Circular Reference Check\n  if (items.some((item) => item.inputItemId === outputItemId)) {\n    return { error: \"Self-reference detected: Output item cannot be an ingredient.\" };\n  }\n\n  // 1. Calculate next version\n  const { data: existingRecipes, error: versionError } = await supabase\n    .from(\"recipes\")\n    .select(\"version\")\n    .eq(\"store_id\", store_id)\n    .eq(\"output_item_id\", outputItemId)\n    .order(\"version\", { ascending: false })\n    .limit(1);\n\n  if (versionError) {\n    return { error: `Version check failed: ${versionError.message}` };\n  }\n\n  const nextVersion = existingRecipes && existingRecipes.length > 0\n    ? existingRecipes[0].version + 1\n    : 1;\n\n  // 2. Insert Recipe\n  const { data: recipe, error: recipeError } = await supabase\n    .from(\"recipes\")\n    .insert({\n      store_id,\n      output_item_id: outputItemId,\n      output_quantity: outputQuantity,\n      version: nextVersion,\n      is_active: true,\n      name,\n      description,\n    })\n    .select()\n    .single();\n\n  if (recipeError) {\n    return { error: `Recipe creation failed: ${recipeError.message}` };\n  }\n\n  // 3. Insert Recipe Items\n  if (items.length > 0) {\n    const recipeItems = items.map((item, index) => ({\n      recipe_id: recipe.id,\n      input_item_id: item.inputItemId,\n      quantity: item.quantity,\n      unit: item.unit,\n      sort_order: index,\n    }));\n\n    const { error: itemsError } = await supabase\n      .from(\"recipe_items\")\n      .insert(recipeItems);\n\n    if (itemsError) {\n      // Rollback: delete the recipe if items fail\n      await supabase.from(\"recipes\").delete().eq(\"id\", recipe.id);\n      return { error: `Failed to add ingredients: ${itemsError.message}` };\n    }\n  }\n\n  // 4. Deactivate previous versions\n  const { error: deactivateError } = await supabase\n    .from(\"recipes\")\n    .update({ is_active: false })\n    .eq(\"store_id\", store_id)\n    .eq(\"output_item_id\", outputItemId)\n    .neq(\"id\", recipe.id); // Exclude the new one\n\n  if (deactivateError) {\n    console.error(\"Failed to deactivate old recipes:\", deactivateError);\n  }\n\n  revalidatePath(\"/dashboard/recipes\");\n  return { success: true, recipeId: recipe.id };\n}\n\nexport async function calculateRecipeCost(items: RecipeItemInput[]) {\n  const supabase = await createClient();\n  let totalCost = 0;\n\n  // Fetch prices for all items\n  const itemIds = items.map((i) => i.inputItemId);\n  const { data: dbItems } = await supabase\n    .from(\"items\")\n    .select(\"id, base_unit, latest_purchase_price\")\n    .in(\"id\", itemIds);\n\n  if (!dbItems) return 0;\n\n  for (const item of items) {\n    const dbItem = dbItems.find((i) => i.id === item.inputItemId);\n    if (!dbItem || !dbItem.latest_purchase_price) continue;\n\n    // Convert unit\n    // We call the DB function for accurate conversion\n    const { data: convertedQty } = await supabase.rpc(\"convert_unit\", {\n      p_quantity: item.quantity,\n      p_from_unit: item.unit,\n      p_to_unit: dbItem.base_unit,\n      p_item_id: item.inputItemId\n    });\n\n    if (convertedQty !== null) {\n      totalCost += (convertedQty as number) * dbItem.latest_purchase_price;\n    }\n  }\n\n  return totalCost;\n}\n\nexport async function getRecipes() {\n  const supabase = await createClient();\n  const { data: { user } } = await supabase.auth.getUser();\n  if (!user) return [];\n\n  const { data } = await supabase\n    .from(\"recipes\")\n    .select(`\n      *,\n      output_item:items!output_item_id(name, code, base_unit),\n      recipe_items(\n        quantity,\n        unit,\n        input_item:items!input_item_id(name, base_unit, latest_purchase_price)\n      )\n    `)\n    .eq(\"is_active\", true)\n    .order(\"created_at\", { ascending: false });\n\n  return data || [];\n}"],"names":[],"mappings":";;;;;;;MAwHsB,wBAAA,WAAA,GAAA,IAAA,+OAAA,EAAA,8CAAA,oOAAA,EAAA,KAAA,GAAA,0OAAA,EAAA,uDAAA"}},
    {"offset": {"line": 445, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Proj/cafe-bakery-saas/src/components/recipes/recipe-builder.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect } from 'react';\nimport { useRouter } from 'next/navigation';\nimport { createClient } from '@/lib/supabase/client';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Textarea } from '@/components/ui/textarea';\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from '@/components/ui/select';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Plus, Trash2, Search, Save, ArrowLeft } from 'lucide-react';\nimport { UnitType, Item } from '@/types/inventory';\nimport { createRecipe, calculateRecipeCost } from '@/app/dashboard/recipes/actions';\nimport { toast } from 'sonner';\n\ninterface RecipeBuilderProps {\n  initialData?: any;\n  items: Item[]; // 원자재 및 반제품 목록\n  mode: 'create' | 'edit';\n}\n\ninterface RecipeItem {\n  input_item_id: string;\n  quantity: number;\n  unit: UnitType;\n  input_item?: Item;\n}\n\nexport function RecipeBuilder({ initialData, items, mode }: RecipeBuilderProps) {\n  const router = useRouter();\n  const [loading, setLoading] = useState(false);\n  \n  // 기본 정보 상태\n  const [name, setName] = useState(initialData?.name || '');\n  const [outputItemId, setOutputItemId] = useState(initialData?.output_item_id || '');\n  const [outputQuantity, setOutputQuantity] = useState(initialData?.output_quantity || 1);\n  const [description, setDescription] = useState(initialData?.description || '');\n  \n  // 레시피 재료 목록 상태\n  const [recipeItems, setRecipeItems] = useState<RecipeItem[]>(\n    initialData?.recipe_items || []\n  );\n  const [estimatedCost, setEstimatedCost] = useState(0);\n\n  // 재료 검색어 상태\n  const [searchTerm, setSearchTerm] = useState('');\n\n  // 완제품(finished) 및 반제품(semi_finished) 목록 필터링 (레시피 대상 품목)\n  const outputCandidates = items.filter(\n    (item) => item.type === 'finished' || item.type === 'semi_finished'\n  );\n\n  // 재료(raw) 및 반제품(semi_finished) 목록 필터링 (레시피 재료)\n  // 자기 자신을 재료로 쓸 수는 없으므로 outputItemId가 선택되었다면 제외해야 함\n  const ingredientCandidates = items.filter(\n    (item) => \n      (item.type === 'raw' || item.type === 'semi_finished') && \n      item.id !== outputItemId\n  ).filter((item) => \n    item.name.toLowerCase().includes(searchTerm.toLowerCase()) ||\n    (item.code && item.code.toLowerCase().includes(searchTerm.toLowerCase()))\n  );\n\n  const handleAddItem = (item: Item) => {\n    // 이미 추가된 재료인지 확인\n    if (recipeItems.some((ri) => ri.input_item_id === item.id)) {\n      toast.error('이미 추가된 재료입니다.');\n      return;\n    }\n\n    setRecipeItems([\n      ...recipeItems,\n      {\n        input_item_id: item.id,\n        quantity: 0,\n        unit: item.base_unit,\n        input_item: item,\n      },\n    ]);\n  };\n\n  const handleRemoveItem = (index: number) => {\n    const newItems = [...recipeItems];\n    newItems.splice(index, 1);\n    setRecipeItems(newItems);\n  };\n\n  const handleItemChange = (index: number, field: keyof RecipeItem, value: any) => {\n    const newItems = [...recipeItems];\n    newItems[index] = { ...newItems[index], [field]: value };\n    setRecipeItems(newItems);\n  };\n\n  // Calculate cost when items change\n  useEffect(() => {\n    const calculate = async () => {\n      if (recipeItems.length === 0) {\n        setEstimatedCost(0);\n        return;\n      }\n      \n      const itemsForCalc = recipeItems.map(item => ({\n        inputItemId: item.input_item_id,\n        quantity: Number(item.quantity),\n        unit: item.unit\n      }));\n\n      // In a real app, you might want to debounce this\n      const cost = await calculateRecipeCost(itemsForCalc);\n      setEstimatedCost(cost);\n    };\n\n    calculate();\n  }, [recipeItems]);\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!outputItemId) {\n      toast.error('생산할 품목을 선택해주세요.');\n      return;\n    }\n\n    if (recipeItems.length === 0) {\n      toast.error('최소 1개 이상의 재료를 추가해주세요.');\n      return;\n    }\n\n    // 유효성 검사: 수량이 0 이하인 재료 확인\n    const invalidItems = recipeItems.filter(item => item.quantity <= 0);\n    if (invalidItems.length > 0) {\n      toast.error('모든 재료의 수량은 0보다 커야 합니다.');\n      return;\n    }\n\n    setLoading(true);\n\n    try {\n      const recipeData = {\n        outputItemId,\n        outputQuantity: Number(outputQuantity),\n        name: name || `${outputCandidates.find(i => i.id === outputItemId)?.name} 레시피`,\n        description,\n        items: recipeItems.map(item => ({\n          inputItemId: item.input_item_id,\n          quantity: Number(item.quantity),\n          unit: item.unit\n        }))\n      };\n\n      if (mode === 'create') {\n        const result = await createRecipe(recipeData);\n        if (result.error) throw new Error(result.error);\n        toast.success('레시피가 생성되었습니다.');\n      } else {\n        // update 로직은 아직 구현되지 않았지만 구조는 비슷함\n        // const result = await updateRecipe(initialData.id, recipeData);\n        // if (result.error) throw new Error(result.error);\n        // toast.success('레시피가 수정되었습니다.');\n        toast.info('수정 기능은 준비 중입니다.');\n      }\n\n      router.push('/dashboard/recipes');\n      router.refresh();\n    } catch (error: any) {\n      toast.error(error.message || '레시피 저장 중 오류가 발생했습니다.');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex items-center gap-4\">\n        <Button variant=\"ghost\" size=\"icon\" onClick={() => router.back()}>\n          <ArrowLeft className=\"h-4 w-4\" />\n        </Button>\n        <h1 className=\"text-2xl font-bold tracking-tight\">\n          {mode === 'create' ? '새 레시피 생성' : '레시피 수정'}\n        </h1>\n      </div>\n\n      <div className=\"grid gap-6 md:grid-cols-2\">\n        {/* 왼쪽: 레시피 기본 정보 및 재료 목록 */}\n        <form onSubmit={handleSubmit} className=\"space-y-6\">\n          <Card>\n            <CardHeader>\n              <CardTitle>기본 정보</CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"outputItem\">생산 품목 (완제품/반제품)</Label>\n                <Select \n                  value={outputItemId} \n                  onValueChange={setOutputItemId}\n                  disabled={mode === 'edit'} // 수정 시에는 품목 변경 불가\n                >\n                  <SelectTrigger>\n                    <SelectValue placeholder=\"품목 선택\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    {outputCandidates.map((item) => (\n                      <SelectItem key={item.id} value={item.id}>\n                        {item.name} ({item.code || 'No Code'})\n                      </SelectItem>\n                    ))}\n                  </SelectContent>\n                </Select>\n              </div>\n\n              <div className=\"grid grid-cols-2 gap-4\">\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"outputQuantity\">생산 수량</Label>\n                  <Input\n                    id=\"outputQuantity\"\n                    type=\"number\"\n                    min=\"0.1\"\n                    step=\"0.1\"\n                    value={outputQuantity}\n                    onChange={(e) => setOutputQuantity(Number(e.target.value))}\n                    required\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>단위</Label>\n                  <div className=\"flex h-10 w-full items-center rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background text-muted-foreground\">\n                    {outputItemId \n                      ? items.find(i => i.id === outputItemId)?.base_unit \n                      : '-'}\n                  </div>\n                </div>\n              </div>\n\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"name\">레시피 명 (선택)</Label>\n                <Input\n                  id=\"name\"\n                  value={name}\n                  onChange={(e) => setName(e.target.value)}\n                  placeholder=\"예: 크로와상 기본 레시피\"\n                />\n              </div>\n\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"description\">설명 / 메모 (선택)</Label>\n                <Textarea\n                  id=\"description\"\n                  value={description}\n                  onChange={(e) => setDescription(e.target.value)}\n                  placeholder=\"조리법이나 특이사항을 입력하세요.\"\n                />\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n              <div className=\"flex flex-col\">\n                <CardTitle>재료 목록 (BOM)</CardTitle>\n                <span className=\"text-sm text-muted-foreground mt-1\">\n                  총 {recipeItems.length}개 재료\n                </span>\n              </div>\n              <div className=\"text-right\">\n                <div className=\"text-sm text-muted-foreground\">예상 원가</div>\n                <div className=\"text-xl font-bold text-primary\">\n                  {estimatedCost.toLocaleString()}원\n                </div>\n              </div>\n            </CardHeader>\n            <CardContent className=\"space-y-4 pt-4\">\n              {recipeItems.length === 0 ? (\n                <div className=\"flex h-32 flex-col items-center justify-center rounded-md border border-dashed text-sm text-muted-foreground\">\n                  <p>우측에서 재료를 선택하여 추가하세요.</p>\n                </div>\n              ) : (\n                <div className=\"space-y-4\">\n                  {recipeItems.map((item, index) => (\n                    <div key={`${item.input_item_id}-${index}`} className=\"flex items-start gap-3 rounded-lg border p-3\">\n                      <div className=\"flex-1 space-y-1\">\n                        <p className=\"font-medium leading-none\">\n                          {item.input_item?.name || items.find(i => i.id === item.input_item_id)?.name}\n                        </p>\n                        <p className=\"text-xs text-muted-foreground\">\n                          {item.input_item?.code || items.find(i => i.id === item.input_item_id)?.code}\n                        </p>\n                      </div>\n                      \n                      <div className=\"flex items-center gap-2\">\n                        <Input\n                          type=\"number\"\n                          className=\"w-20\"\n                          min=\"0.001\"\n                          step=\"0.001\"\n                          value={item.quantity}\n                          onChange={(e) => handleItemChange(index, 'quantity', Number(e.target.value))}\n                        />\n                        <Select\n                          value={item.unit}\n                          onValueChange={(value) => handleItemChange(index, 'unit', value)}\n                        >\n                          <SelectTrigger className=\"w-20\">\n                            <SelectValue />\n                          </SelectTrigger>\n                          <SelectContent>\n                            <SelectItem value=\"g\">g</SelectItem>\n                            <SelectItem value=\"kg\">kg</SelectItem>\n                            <SelectItem value=\"ml\">ml</SelectItem>\n                            <SelectItem value=\"l\">l</SelectItem>\n                            <SelectItem value=\"ea\">ea</SelectItem>\n                          </SelectContent>\n                        </Select>\n                        <Button\n                          type=\"button\"\n                          variant=\"ghost\"\n                          size=\"icon\"\n                          className=\"text-destructive hover:text-destructive/90\"\n                          onClick={() => handleRemoveItem(index)}\n                        >\n                          <Trash2 className=\"h-4 w-4\" />\n                        </Button>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              )}\n            </CardContent>\n          </Card>\n\n          <div className=\"flex justify-end gap-4\">\n            <Button type=\"button\" variant=\"outline\" onClick={() => router.back()}>\n              취소\n            </Button>\n            <Button type=\"submit\" disabled={loading}>\n              {loading && <div className=\"mr-2 h-4 w-4 animate-spin rounded-full border-2 border-current border-t-transparent\" />}\n              <Save className=\"mr-2 h-4 w-4\" />\n              저장하기\n            </Button>\n          </div>\n        </form>\n\n        {/* 오른쪽: 재료 검색 및 추가 패널 */}\n        <div className=\"space-y-6\">\n          <Card className=\"h-full max-h-[calc(100vh-10rem)] overflow-hidden flex flex-col\">\n            <CardHeader>\n              <CardTitle>재료 검색</CardTitle>\n              <div className=\"relative pt-2\">\n                <Search className=\"absolute left-2 top-4.5 h-4 w-4 text-muted-foreground\" />\n                <Input\n                  placeholder=\"재료명 또는 코드 검색...\"\n                  className=\"pl-8\"\n                  value={searchTerm}\n                  onChange={(e: React.ChangeEvent<HTMLInputElement>) => setSearchTerm(e.target.value)}\n                />\n              </div>\n            </CardHeader>\n            <CardContent className=\"flex-1 overflow-auto\">\n              <div className=\"space-y-2\">\n                {ingredientCandidates.length === 0 ? (\n                  <p className=\"text-center text-sm text-muted-foreground py-8\">\n                    검색 결과가 없습니다.\n                  </p>\n                ) : (\n                  ingredientCandidates.map((item) => {\n                    const isAdded = recipeItems.some(ri => ri.input_item_id === item.id);\n                    return (\n                      <div\n                        key={item.id}\n                        className={`flex items-center justify-between rounded-lg border p-3 transition-colors ${\n                          isAdded ? 'bg-muted opacity-50' : 'hover:bg-accent cursor-pointer'\n                        }`}\n                        onClick={() => !isAdded && handleAddItem(item)}\n                      >\n                        <div>\n                          <p className=\"font-medium\">{item.name}</p>\n                          <div className=\"flex items-center gap-2 text-xs text-muted-foreground\">\n                            <span className=\"rounded bg-secondary px-1 py-0.5\">\n                              {item.type === 'raw' ? '원자재' : '반제품'}\n                            </span>\n                            <span>{item.code}</span>\n                            <span>•</span>\n                            <span>기준단위: {item.base_unit}</span>\n                          </div>\n                        </div>\n                        <Button\n                          type=\"button\"\n                          variant=\"ghost\"\n                          size=\"icon\"\n                          disabled={isAdded}\n                        >\n                          <Plus className=\"h-4 w-4\" />\n                        </Button>\n                      </div>\n                    );\n                  })\n                )}\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n      </div>\n    </div>\n  );\n}"],"names":[],"mappings":"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"}}]
}